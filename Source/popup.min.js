var Popup=(function(){function f(k,j){var l=this;this._options={name:null,status:0,toolbar:0,location:0,menubar:0,directories:0,resizable:0,scrollbars:0,height:900,width:400,x:"center",y:"center"};this._window=null;this._url="";this._reference=-1;this._events={};this.setOptions(j);this._url=k;if(!this._options.name){if(typeof(window.UID)=="undefined"){window.UID=new Date().getTime()}window.UID++;this._options.name=window.UID.toString()}f.subscribeEntity(this);window.addEventListener("message",function(m){l._receiveMessage(m)})}f.subscribeEntity=function d(j){j._reference=f._count;f._reference[f._count]=j;f._count++};f.remove=function c(j){delete f._reference[j.reference]};f._count=0;f._reference=[];f._events={};f._closeInterval=null;f.addEventListener=function b(j,k){if(typeof(f._events[j])=="undefined"){f._events[j]=[]}f._events[j].push(k)};f.dispatchEvent=function e(k,m,j){if(typeof j==="undefined"){j=true}if(!j){if(typeof(f._events[k])!="undefined"){for(var l=0;l<f._events[k].length;l++){f._events[k][l].call(null,m)}}}else{var n=f.encodePostMessage(k,m);window.opener.postMessage(f.encodePostMessage(k,m),location.origin)}};f.receiveMessage=function g(k){var j=f.decodePostMessage(k.data);f.dispatchEvent(j.name,j.data,false)};f.close=function h(){window.close()};f.encodePostMessage=function i(j,k){return JSON.stringify({name:j,data:k})};f.decodePostMessage=function a(j){return JSON.parse(j)};f.prototype.setOptions=function(j){for(var k in this._options){if(this._options.hasOwnProperty(k)){if(typeof(j[k])!="undefined"){this._options[k]=j[k]}}}};f.prototype.set=function(j,k){if(typeof(this._options[j])!=="undefined"){this._options[j]=k;if(j==="x"||j==="y"){this._moveTo()}}return this};f.prototype.get=function(j){if(typeof(this._options[j])!=="undefined"){return this._options[j]}return false};f.prototype.addEventListener=function(j,k){if(typeof(this._events[j])=="undefined"){this._events[j]=[]}this._events[j].push(k)};f.prototype.dispatchEvent=function(k,m,j){if(typeof j==="undefined"){j=true}if(!j){if(typeof(this._events[k])!="undefined"){for(var l=0;l<this._events[k].length;l++){this._events[k][l].call(null,m)}}}else{this._window.postMessage(f.encodePostMessage(k,m),"*")}};f.prototype._receiveMessage=function(k){var j=f.decodePostMessage(k.data);this.dispatchEvent(j.name,j.data,false)};f.prototype.open=function(){var m=this;var l=[];var j,k;for(j in this._options){if(this._options.hasOwnProperty(j)){k=this._options[j];if(!(j=="x"||j=="y"||j=="name")){if(j=="width"||j=="height"){k=parseInt(k)+"px"}l.push(j+"="+k)}}}this._window=window.open(this._url,this._options.name,l.join(","));this._window.addEventListener("message",function(n){m._receiveMessage(n)});this._moveTo()};f.prototype._moveTo=function(){if(this._window==null){return}var j=this.get("x");var k=this.get("y");if(typeof(j)=="string"){switch(j){case"center":j=(window.screen.width-this.get("width"))/2;break;case"left":j=0;break;case"right":j=(window.screen.width-this.get("width"));break}}if(typeof(k)=="string"){switch(k){case"center":k=(window.screen.height-this.get("height"))/2;break;case"top":k=0;break;case"bottom":k=(window.screen.height-this.get("height"));break}}this._window.moveTo(parseInt(j),parseInt(k))};f.prototype.close=function(){if(this._window===null){return}this._window.close();f.remove(this)};f.prototype._checkFiredEvents=function(){};f.prototype.getWindow=function(){return this._window};return f})();window.addEventListener("message",function(a){Popup.receiveMessage(a)},false);